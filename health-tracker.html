<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="utf-8">
	<title>Health Tracker - TechCloud</title>
	<meta name="description" content="Comprehensive health monitoring application for tracking vital health metrics with AI insights">
	<meta name="keywords" content="TechCloud,Health,Tracker,Blood Sugar,Blood Pressure,Monitoring">
	<meta name="viewport" content="width=device-width, initial-scale=1.0">
	
	<!-- Styles -->
	<link href="css/bootstrap.min.css" rel="stylesheet">
	<link href="css/font-awesome.min.css" rel="stylesheet">
	<link href="css/style.css" rel="stylesheet">
	
	<!-- Google Fonts -->
	<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&family=Poppins:wght@300;400;500;600;700&display=swap" rel="stylesheet">
	
	<!-- Chart.js for health charts -->
	<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
	
	<link rel="shortcut icon" href="#">
</head>

<body>
	<div class="wrapper">
		<!-- Modern Navigation -->
		<nav class="navbar navbar-expand-lg navbar-dark fixed-top modern-nav">
			<div class="container">
				<a class="navbar-brand" href="index.html">
					<img src="img/logo.png" alt="TechCloud" class="logo">
					<span class="brand-text">TechCloud</span>
				</a>
				
				<button class="navbar-toggler" type="button" data-toggle="collapse" data-target="#navbarNav">
					<span class="navbar-toggler-icon"></span>
				</button>
				
				<div class="collapse navbar-collapse" id="navbarNav">
					<ul class="navbar-nav ml-auto">
						<li class="nav-item">
							<a class="nav-link" href="index.html">Home</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="index.html#about">About</a>
						</li>
						<li class="nav-item">
							<a class="nav-link" href="index.html#contact">Contact</a>
						</li>
						<li class="nav-item auth-links">
							<a class="nav-link" href="login.html">Login</a>
						</li>
						<li class="nav-item auth-links">
							<a class="nav-link btn btn-outline-light ml-2" href="registration.html">Sign Up</a>
						</li>
						<li class="nav-item user-info" style="display: none;">
							<div class="nav-link">
								Welcome, <span class="user-name"></span>
							</div>
						</li>
						<li class="nav-item user-info" style="display: none;">
							<a class="nav-link btn btn-outline-light ml-2" href="#" onclick="authManager.signOut()">Logout</a>
						</li>
					</ul>
				</div>
			</div>
		</nav>

		<!-- Health Dashboard -->
		<section class="health-dashboard">
			<div class="container-fluid">
				<div class="row">
					<!-- Sidebar -->
					<div class="col-lg-3 col-md-4 sidebar">
						<div class="sidebar-content">
							<div class="app-header">
								<h2><i class="fa fa-heartbeat"></i> Health Tracker</h2>
								<p class="text-muted">Comprehensive Health Monitoring</p>
							</div>
							
							<div class="health-summary">
								<div class="summary-card">
									<h4>Today's Status</h4>
									<div class="status-indicator good">
										<i class="fa fa-check-circle"></i> Good
									</div>
									<p class="text-muted">All vitals within normal range</p>
								</div>
								
								<div class="summary-card">
									<h4>Last Reading</h4>
									<div class="last-reading">
										<strong>Blood Sugar:</strong> 95 mg/dL<br>
										<small class="text-muted">2 hours ago</small>
									</div>
								</div>
							</div>
							
							<div class="quick-actions">
								<h5>Quick Actions</h5>
								<button class="btn btn-primary-gradient btn-block mb-2" onclick="showAddReadingModal('blood_sugar')">
									<i class="fa fa-tint"></i> Blood Sugar
								</button>
								<button class="btn btn-outline-primary btn-block mb-2" onclick="showAddReadingModal('blood_pressure')">
									<i class="fa fa-heart"></i> Blood Pressure
								</button>
								<button class="btn btn-outline-primary btn-block mb-2" onclick="showAddReadingModal('heart_rate')">
									<i class="fa fa-heartbeat"></i> Heart Rate
								</button>
								<button class="btn btn-outline-secondary btn-block" onclick="showAddReadingModal('temperature')">
									<i class="fa fa-thermometer-half"></i> Temperature
								</button>
							</div>
							
							<div class="health-goals">
								<h5>Health Goals</h5>
								<div class="goal-item">
									<span>Daily Water Intake</span>
									<div class="progress">
										<div class="progress-bar" style="width: 65%">6.5/10 glasses</div>
									</div>
								</div>
								<div class="goal-item">
									<span>Exercise Minutes</span>
									<div class="progress">
										<div class="progress-bar bg-success" style="width: 80%">24/30 min</div>
									</div>
								</div>
							</div>
						</div>
					</div>
					
					<!-- Main Content -->
					<div class="col-lg-9 col-md-8 main-content">
						<div class="dashboard-header">
							<h3>Health Overview</h3>
							<div class="header-actions">
								<button class="btn btn-outline-primary" onclick="exportData()">
									<i class="fa fa-download"></i> Export Data
								</button>
								<select class="form-control ml-2" style="width: auto; display: inline-block;" id="timeRange">
									<option value="7">Last 7 Days</option>
									<option value="30">Last 30 Days</option>
									<option value="90">Last 90 Days</option>
									<option value="365">Last Year</option>
								</select>
							</div>
						</div>
						
						<!-- Vital Signs Cards -->
						<div class="row mb-4">
							<div class="col-lg-3 col-md-6 mb-3">
								<div class="vital-card blood-sugar">
									<div class="vital-icon">
										<i class="fa fa-tint"></i>
									</div>
									<div class="vital-info">
										<h6>Blood Sugar</h6>
										<div class="vital-value">95 <span class="unit">mg/dL</span></div>
										<div class="vital-status normal">Normal</div>
									</div>
								</div>
							</div>
							<div class="col-lg-3 col-md-6 mb-3">
								<div class="vital-card blood-pressure">
									<div class="vital-icon">
										<i class="fa fa-heart"></i>
									</div>
									<div class="vital-info">
										<h6>Blood Pressure</h6>
										<div class="vital-value">120/80 <span class="unit">mmHg</span></div>
										<div class="vital-status normal">Normal</div>
									</div>
								</div>
							</div>
							<div class="col-lg-3 col-md-6 mb-3">
								<div class="vital-card heart-rate">
									<div class="vital-icon">
										<i class="fa fa-heartbeat"></i>
									</div>
									<div class="vital-info">
										<h6>Heart Rate</h6>
										<div class="vital-value">72 <span class="unit">bpm</span></div>
										<div class="vital-status normal">Normal</div>
									</div>
								</div>
							</div>
							<div class="col-lg-3 col-md-6 mb-3">
								<div class="vital-card temperature">
									<div class="vital-icon">
										<i class="fa fa-thermometer-half"></i>
									</div>
									<div class="vital-info">
										<h6>Temperature</h6>
										<div class="vital-value">98.6 <span class="unit">°F</span></div>
										<div class="vital-status normal">Normal</div>
									</div>
								</div>
							</div>
						</div>
						
						<!-- Charts Row -->
						<div class="row mb-4">
							<div class="col-lg-6">
								<div class="chart-card">
									<h5>Blood Sugar Trends</h5>
									<canvas id="bloodSugarChart"></canvas>
								</div>
							</div>
							<div class="col-lg-6">
								<div class="chart-card">
									<h5>Blood Pressure Trends</h5>
									<canvas id="bloodPressureChart"></canvas>
								</div>
							</div>
						</div>
						
						<!-- Recent Readings -->
						<div class="readings-section">
							<div class="section-header">
								<h5>Recent Readings</h5>
								<div class="filter-buttons">
									<button class="btn btn-sm btn-outline-primary active" data-filter="all">All</button>
									<button class="btn btn-sm btn-outline-primary" data-filter="blood_sugar">Blood Sugar</button>
									<button class="btn btn-sm btn-outline-primary" data-filter="blood_pressure">Blood Pressure</button>
									<button class="btn btn-sm btn-outline-primary" data-filter="heart_rate">Heart Rate</button>
								</div>
							</div>
							
							<div class="table-responsive">
								<table class="table table-hover readings-table">
									<thead>
										<tr>
											<th>Date & Time</th>
											<th>Type</th>
											<th>Value</th>
											<th>Status</th>
											<th>Notes</th>
											<th>Actions</th>
										</tr>
									</thead>
									<tbody id="readingsTableBody">
										<!-- Readings will be populated by JavaScript -->
									</tbody>
								</table>
							</div>
						</div>
					</div>
				</div>
			</div>
		</section>

		<!-- Add Reading Modal -->
		<div class="modal fade" id="addReadingModal" tabindex="-1">
			<div class="modal-dialog">
				<div class="modal-content">
					<div class="modal-header">
						<h5 class="modal-title" id="readingModalTitle">Add Reading</h5>
						<button type="button" class="close" data-dismiss="modal">
							<span>&times;</span>
						</button>
					</div>
					<div class="modal-body">
						<form id="readingForm">
							<input type="hidden" id="readingType">
							<div class="form-group">
								<label>Date & Time</label>
								<input type="datetime-local" class="form-control" id="readingDateTime" required>
							</div>
							<div id="bloodSugarFields" style="display: none;">
								<div class="form-group">
									<label>Blood Sugar Level (mg/dL)</label>
									<input type="number" class="form-control" id="bloodSugarValue" placeholder="e.g., 95">
								</div>
							</div>
							<div id="bloodPressureFields" style="display: none;">
								<div class="row">
									<div class="col-6">
										<div class="form-group">
											<label>Systolic (mmHg)</label>
											<input type="number" class="form-control" id="systolicValue" placeholder="e.g., 120">
										</div>
									</div>
									<div class="col-6">
										<div class="form-group">
											<label>Diastolic (mmHg)</label>
											<input type="number" class="form-control" id="diastolicValue" placeholder="e.g., 80">
										</div>
									</div>
								</div>
							</div>
							<div id="heartRateFields" style="display: none;">
								<div class="form-group">
									<label>Heart Rate (bpm)</label>
									<input type="number" class="form-control" id="heartRateValue" placeholder="e.g., 72">
								</div>
							</div>
							<div id="temperatureFields" style="display: none;">
								<div class="form-group">
									<label>Temperature (°F)</label>
									<input type="number" class="form-control" id="temperatureValue" step="0.1" placeholder="e.g., 98.6">
								</div>
							</div>
							<div class="form-group">
								<label>Notes (Optional)</label>
								<textarea class="form-control" id="readingNotes" rows="3" placeholder="Any additional notes..."></textarea>
							</div>
						</form>
					</div>
					<div class="modal-footer">
						<button type="button" class="btn btn-secondary" data-dismiss="modal">Cancel</button>
						<button type="button" class="btn btn-primary" onclick="saveReading()">Save Reading</button>
					</div>
				</div>
			</div>
		</div>
	</div>

	<!-- Scripts -->
	<script src="https://cdn.jsdelivr.net/npm/supabase-js@2"></script>
	<script src="js/supabase-config.js"></script>
	<script src="js/jquery-3.2.1.min.js"></script>
	<script src="js/bootstrap.min.js"></script>
	<script src="js/custom.js"></script>
	<script src="js/auth.js"></script>
	
	<!-- Health Tracker JavaScript -->
	<script>
		// Sample health data
		const healthData = {
			readings: [
				{ id: 1, type: 'blood_sugar', value: '95', datetime: '2024-01-15T14:30', status: 'normal', notes: 'After lunch' },
				{ id: 2, type: 'blood_pressure', value: '120/80', datetime: '2024-01-15T09:00', status: 'normal', notes: 'Morning reading' },
				{ id: 3, type: 'heart_rate', value: '72', datetime: '2024-01-15T08:45', status: 'normal', notes: 'Resting rate' },
				{ id: 4, type: 'temperature', value: '98.6', datetime: '2024-01-15T07:00', status: 'normal', notes: 'Morning temp' },
				{ id: 5, type: 'blood_sugar', value: '88', datetime: '2024-01-14T18:00', status: 'normal', notes: 'Before dinner' }
			]
		};

		// Initialize health dashboard
		document.addEventListener('DOMContentLoaded', function() {
			initializeCharts();
			populateReadingsTable();
			setupEventListeners();
			setCurrentDateTime();
		});

		function initializeCharts() {
			// Blood Sugar Chart
			const ctx1 = document.getElementById('bloodSugarChart').getContext('2d');
			new Chart(ctx1, {
				type: 'line',
				data: {
					labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
					datasets: [{
						label: 'Blood Sugar (mg/dL)',
						data: [92, 88, 95, 90, 93, 89, 95],
						borderColor: '#f5576c',
						backgroundColor: 'rgba(245, 87, 108, 0.1)',
						tension: 0.4
					}]
				},
				options: {
					responsive: true,
					plugins: {
						legend: { display: false }
					},
					scales: {
						y: {
							beginAtZero: false,
							min: 70,
							max: 140
						}
					}
				}
			});

			// Blood Pressure Chart
			const ctx2 = document.getElementById('bloodPressureChart').getContext('2d');
			new Chart(ctx2, {
				type: 'line',
				data: {
					labels: ['Mon', 'Tue', 'Wed', 'Thu', 'Fri', 'Sat', 'Sun'],
					datasets: [{
						label: 'Systolic',
						data: [118, 122, 120, 119, 121, 118, 120],
						borderColor: '#667eea',
						backgroundColor: 'rgba(102, 126, 234, 0.1)'
					}, {
						label: 'Diastolic',
						data: [78, 82, 80, 79, 81, 78, 80],
						borderColor: '#764ba2',
						backgroundColor: 'rgba(118, 75, 162, 0.1)'
					}]
				},
				options: {
					responsive: true,
					plugins: {
						legend: { position: 'bottom' }
					},
					scales: {
						y: {
							beginAtZero: false,
							min: 60,
							max: 140
						}
					}
				}
			});
		}

		function populateReadingsTable() {
			const tbody = document.getElementById('readingsTableBody');
			tbody.innerHTML = '';

			healthData.readings.forEach(reading => {
				const date = new Date(reading.datetime);
				const formattedDate = date.toLocaleDateString() + ' ' + date.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'});
				const statusClass = reading.status === 'normal' ? 'badge-success' : reading.status === 'high' ? 'badge-danger' : 'badge-warning';
				
				const typeLabels = {
					'blood_sugar': 'Blood Sugar',
					'blood_pressure': 'Blood Pressure',
					'heart_rate': 'Heart Rate',
					'temperature': 'Temperature'
				};

				const row = `
					<tr data-type="${reading.type}">
						<td>${formattedDate}</td>
						<td><span class="badge badge-primary">${typeLabels[reading.type]}</span></td>
						<td><strong>${reading.value}</strong></td>
						<td><span class="badge ${statusClass}">${reading.status}</span></td>
						<td>${reading.notes || '-'}</td>
						<td>
							<button class="btn btn-sm btn-outline-danger" onclick="deleteReading(${reading.id})">
								<i class="fa fa-trash"></i>
							</button>
						</td>
					</tr>
				`;
				tbody.innerHTML += row;
			});
		}

		function setupEventListeners() {
			// Filter buttons
			document.querySelectorAll('[data-filter]').forEach(btn => {
				btn.addEventListener('click', function() {
					document.querySelectorAll('[data-filter]').forEach(b => b.classList.remove('active'));
					this.classList.add('active');
					
					const filter = this.dataset.filter;
					const rows = document.querySelectorAll('#readingsTableBody tr');
					
					rows.forEach(row => {
						if (filter === 'all' || row.dataset.type === filter) {
							row.style.display = '';
						} else {
							row.style.display = 'none';
						}
					});
				});
			});

			// Time range change
			document.getElementById('timeRange').addEventListener('change', function() {
				// Simulate data refresh for different time ranges
				console.log('Time range changed to:', this.value + ' days');
			});
		}

		function setCurrentDateTime() {
			const now = new Date();
			const datetime = now.toISOString().slice(0, 16);
			document.getElementById('readingDateTime').value = datetime;
		}

		function showAddReadingModal(type) {
			const modal = document.getElementById('addReadingModal');
			const typeInput = document.getElementById('readingType');
			const title = document.getElementById('readingModalTitle');
			
			// Hide all field groups
			document.querySelectorAll('[id$="Fields"]').forEach(group => {
				group.style.display = 'none';
			});
			
			// Show relevant fields and set title
			typeInput.value = type;
			switch(type) {
				case 'blood_sugar':
					title.textContent = 'Add Blood Sugar Reading';
					document.getElementById('bloodSugarFields').style.display = 'block';
					break;
				case 'blood_pressure':
					title.textContent = 'Add Blood Pressure Reading';
					document.getElementById('bloodPressureFields').style.display = 'block';
					break;
				case 'heart_rate':
					title.textContent = 'Add Heart Rate Reading';
					document.getElementById('heartRateFields').style.display = 'block';
					break;
				case 'temperature':
					title.textContent = 'Add Temperature Reading';
					document.getElementById('temperatureFields').style.display = 'block';
					break;
			}
			
			setCurrentDateTime();
			$('#addReadingModal').modal('show');
		}

		function saveReading() {
			const type = document.getElementById('readingType').value;
			const datetime = document.getElementById('readingDateTime').value;
			const notes = document.getElementById('readingNotes').value;
			
			let value = '';
			let isValid = true;
			
			switch(type) {
				case 'blood_sugar':
					value = document.getElementById('bloodSugarValue').value;
					if (!value) isValid = false;
					break;
				case 'blood_pressure':
					const systolic = document.getElementById('systolicValue').value;
					const diastolic = document.getElementById('diastolicValue').value;
					if (!systolic || !diastolic) isValid = false;
					value = systolic + '/' + diastolic;
					break;
				case 'heart_rate':
					value = document.getElementById('heartRateValue').value;
					if (!value) isValid = false;
					break;
				case 'temperature':
					value = document.getElementById('temperatureValue').value;
					if (!value) isValid = false;
					break;
			}
			
			if (!isValid || !datetime) {
				alert('Please fill in all required fields.');
				return;
			}
			
			// Simulate saving
			const newReading = {
				id: Date.now(),
				type: type,
				value: value,
				datetime: datetime,
				status: 'normal',
				notes: notes
			};
			
			healthData.readings.unshift(newReading);
			populateReadingsTable();
			
			// Reset form and close modal
			document.getElementById('readingForm').reset();
			setCurrentDateTime();
			$('#addReadingModal').modal('hide');
			
			alert('Reading saved successfully!');
		}

		function deleteReading(id) {
			if (confirm('Are you sure you want to delete this reading?')) {
				healthData.readings = healthData.readings.filter(r => r.id !== id);
				populateReadingsTable();
				alert('Reading deleted successfully!');
			}
		}

		function exportData() {
			// Simulate data export
			alert('Exporting health data... This feature will generate a PDF report with your health trends.');
		}
	</script>
</body>
</html>
